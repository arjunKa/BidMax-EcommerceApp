<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="styles/ItemStyle.css">
	<title>Item Details</title>

</head>

<script>
	// Fetch the username from the server using AJAX
	function fetchUsername() {
		var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function () {
			if (xhr.readyState == 4 && xhr.status == 200) {
				// Update the username display element
				document.getElementById("usernameDisplay").innerText = "User Id: " + xhr.responseText;
			}
		};
		xhr.open("GET", "GetUsernameServlet", true);
		xhr.send();
	}

	window.onload = function () {
		fetchUsername();
	};

</script>

<body>

	<header>
		<h1>BEZOS</h1>
		<!-- Add an element to display the username -->
		<p id="usernameDisplay"></p>
	</header>

	<div class="flex-container">
		<h1>Item Details</h1>
	</div>
	<div class="main">
		<div class="item-details">
			<p><strong>Item Name:</strong> <span id="itemName"></span></p>
			<p><strong>Current Price:</strong> <span id="currentPrice"></span></p>
			<p><strong>Auction Type:</strong> <span id="auctionType"></span></p>
			<p><strong>Remaining Time:</strong> <span id="remainingTime"></span></p>
			<p><strong>Description:</strong> <span id="description"></span></p>
			<p><strong>Shipping Price:</strong> <span id="shippingPrice"></span></p>
			<button id="payNowButton" onclick="handlePayment()">Pay Now</button>

		</div>
	</div>





	<script>
		// Function to get query parameters from the URL
		function getQueryParam(param) {
			var urlParams = new URLSearchParams(window.location.search);
			return urlParams.get(param);
		}

		// Set item details from query parameters
		document.getElementById("itemName").innerText = getQueryParam("itemName");
		document.getElementById("currentPrice").innerText = getQueryParam("currentPrice");
		document.getElementById("auctionType").innerText = getQueryParam("auctionType");
		document.getElementById("remainingTime").innerText = getQueryParam("remainingTime");
		document.getElementById("shippingPrice").innerText = getQueryParam("shipping");
		document.getElementById("description").innerText = getQueryParam("description");

		// Fetch additional details from the server
		fetchDetails(getQueryParam("itemName"));

		function fetchDetails(itemName) {
			// Perform an AJAX request to the server to get additional details
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200) {
					// Update the HTML content with the received details
					var details = JSON.parse(this.responseText);
					document.getElementById("description").innerText = details.description;
					document.getElementById("shippingPrice").innerText = details.shippingPrice;
				}
			};
			xhttp.open("GET", "getDetails?itemName=" + itemName, true);
			xhttp.send();
		}

		function handlePayment() {
			// Implement your payment logic here
			alert("Payment logic goes here!");
		}
	</script>
</body>

</html>